<ion-header #header>
  <div class="header">
    <div class="back">
      <ion-item lines="none" style="--background:none; margin-left: -45px;">
        <ion-button mode="ios" Fill="clear" (click)="backToList()">
          <ion-icon name="chevron-back-outline">
          </ion-icon>
        </ion-button>
        <ion-label style="text-align: center; color: white; padding-right: 38px; font-size: 25px;">
          รายละเอียดการสั่งซื้อ
        </ion-label>
      </ion-item>
    </div>
  </div>
</ion-header>
<ion-content [fullscreen]="true" scrollEvents="true" appHideheader [header]="header">
  <div class="overlay" style="max-width: 600px; margin-left: auto; margin-right:auto; overflow: auto;">
    <div style=" max-width: 600px;  margin-left: auto; margin-right:auto;">

      <div *ngIf="!detail" style="text-align: center;">
        <div class="img_empty">
          <img src="https://image.flaticon.com/icons/png/512/1164/1164570.png">
        </div>
        <div style="margin-top:10px; padding-left: -5px;"></div>
        <ion-label style="font-size: 20px; color:#CF363C">กำลังโหลดข้อมูล</ion-label>
      </div>

      <div *ngIf="detail">
        <div class="body">
          <ion-card mode="ios" style="--background:white;">
            <ion-list style="background:none;">
              <ion-list style="padding: 15px;padding-top: 10px; padding-left: 30px; padding-right: 0;background:none;">
                <ion-item lines="none"
                  style="width: 100%; display: inline-block; padding-right: 35px;--background:none;">
                  <ion-label *ngIf="detail.orderType == 1" style="margin: 0; text-align: center; font-size: 20px; color: #3045a8;">FOOD DELIVERY
                  </ion-label>
                  <ion-label *ngIf="detail.orderType == 2" style="margin: 0; text-align: center; font-size: 20px; color: #3045a8;">DINE-IN
                  </ion-label>
                </ion-item>

                <div class="img_success" *ngIf="detail.statusOrStore_id == '0'">
                  <img src="assets\icon\status_id5.png" alt="">
                </div>

                <div class="img_success" *ngIf="detail.statusOrStore_id == '3'">
                  <img src="assets\icon\status_id3.png" alt="">
                </div>

                <div class="img_success" *ngIf="detail.statusOrStore_id == '2'">
                  <img src="assets\icon\status_id2.png" alt="">
                </div>

                <div class="img_success" *ngIf="detail.statusOrStore_id == '1'">
                  <img src="assets\icon\status_id1.png" alt="">
                </div>

              </ion-list>
              <ion-item lines="none"
                style="--padding-start:10px;--background:none; margin-top: -15px; margin-bottom: 10px;">

                <ion-label *ngIf="detail.statusOrStore_id == '0'"
                  style="text-align: center; margin: 0; font-size: 25px; color: #CF363C;">
                  {{detail.statusOrStore_name}}
                </ion-label>

                <ion-label *ngIf="detail.statusOrStore_id != '0'"
                  style="text-align: center; margin: 0; font-size: 25px; color: #05be4f;">
                  {{detail.statusOrStore_name}}
                </ion-label>
              </ion-item>
            </ion-list>
          </ion-card>

          <ion-list class="menu" lines="none" style=" margin-top:15px; padding:0; background: #e8e8e8;">

            <ion-item lines="none" style="--background:#e8e8e8; align-items: flex-end;">
              <ion-label
                style=" padding-left: 10px; margin:0; font-size: 20px; margin-bottom: 10px; width: 100%; color: #3045a8; ">
                Order #{{detail.order_num}}
              </ion-label>
              <div class="button-receipt" *ngIf="detail.statusOrStore_id != '3'">
                <div style="margin-top: -5px; "></div>
                <ion-button mode="ios" Fill="clear" style="font-size:15px; margin-bottom: 10px;"
                  (click)="presentCancelConfirm(detail.order_id)">
                  ยกเลิก
                </ion-button>
              </div>
            </ion-item>

            <ion-item lines="none" style="--background:white;">
              <ion-label style=" padding-left: 10px; margin:0; font-size: 15px; width: 100%; color: #666666; ">
                จำนวน {{detail.amount}} รายการ
              </ion-label>
            </ion-item>
            <ion-item lines="none" style="margin-top:-15px; --background:white;">
              <ion-label style=" padding-left: 10px; margin:0; font-size: 15px; width: 100%; color: #666666; ">
                สั่งเมื่อ {{detail.date_time}} น.</ion-label>
            </ion-item>
            <ion-item lines="none" style="--background:#e8e8e8; ">
              <ion-label style=" padding-left: 10px; margin:0; font-size: 20px; width: 100%; color: #3045a8; ">
                คนขับ</ion-label>
            </ion-item>
            <ion-item lines="none" style="--background:white;">
              <div class="img-header"
                style="width:50px; display: inline-block; text-align: center; margin-top: 10px; vertical-align: top;">
                <ion-img style="display: inline-block; width:30px; height:30px;" src="assets\icon\rider.png">
                </ion-img>
              </div>
              <ion-label style=" padding-left: 27px; margin:0; font-size: 15px; width: 100%; color: #666666; ">
                ชื่อ : {{detail.rider_name}}</ion-label>
            </ion-item>
            <ion-item lines="none" style="--background:#e8e8e8; ">
              <ion-label style=" padding-left: 10px; margin:0; font-size: 20px; width: 100%; color: #3045a8; ">
                ลูกค้า</ion-label>
            </ion-item>
            <ion-item lines="none" style="--background:white;">
              <div class="card-header" style="width: 100%; display: inline-block;">
                <div class="img-header"
                  style="width:50px; display: inline-block; text-align: center; margin-top: 25px; vertical-align: top;">
                  <ion-img style="display: inline-block; width:30px; height:30px;" src="assets\icon\user.png">
                  </ion-img>
                </div>
                <div style="margin-top:5px; width: calc(100% - 55px); display: inline-block; padding-left: 10px;">
                  <ion-item lines="none" style="--background:white;">
                    <ion-label
                      style="display: inline-block; margin: 0; font-size: 15px; width: 100%; text-align: left; color: #666666;">
                      ชื่อ : {{detail.member_name}}</ion-label>
                  </ion-item>
                  <ion-item lines="none" style="margin-top: -15px; --background:none;">
                    <div>
                      <ion-label style="margin: 0; text-align: left; font-size: 15px; color: #666666;">
                        เบอร์โทรติดต่อ : {{detail.phone}}
                      </ion-label>
                    </div>
                    <ion-button Fill="clear" mode="ios" href="tel:{{detail.phone}}"
                      style="margin-left: 10px;color:#3045a8;">
                      <ion-icon name="call-outline" style="font-size: 15px;"></ion-icon>
                    </ion-button>
                  </ion-item>
                </div>
              </div>
            </ion-item>
          </ion-list>

          <ion-list class="menu" lines="full" style="margin-top:-5px; ">
            <ion-item lines="none" style="--background:#e8e8e8;">
              <div style="width: 100%;">
                <ion-label style=" padding-left: 10px; font-size: 20px; width: 100%; color: #3045a8; ">
                  รายการ
                </ion-label>
              </div>
            </ion-item>

            <ion-list lines="none" style="padding: 0; padding-top:10px; padding-bottom:10px; background:white;">
              <div style="height:10px;"></div>
              <!-- <div *ngFor="let o of detail.food ; let i = index">
                <ng-template [ngIf]="!o.food_detail">  
                  <div class="store">
                    <div class="id_order" style="width:100%; margin-top:-10px;">
                      <ion-grid style="--ion-grid-padding:0">
                        <ion-row>
                          <ion-col size="8.5" style="--ion-grid-column-padding:0">
                            <ion-item lines="none" style="--background:none">
                              <ion-button (click)="editDetail(o)"  mode="ios" Fill="clear">
                                <ion-icon name="pencil" color="dark"></ion-icon>
                              </ion-button>
                              <ion-label style="color: #434343; margin:0; font-size: 16px;">(x{{o.amount}}) {{o.food_name}}  
                                <div *ngIf="o.option">
                                  <span *ngFor="let opt of o.option"
                                    style="padding-left: 25px; font-size: 14px; color: #666666;">*{{opt.title}}<br>
                                  </span>
                                </div>
                              </ion-label>
                            </ion-item>
                          </ion-col>
                          <ion-col size="3.5" style="--ion-grid-column-padding:0">
                            <ion-item lines="none" style="--background:none; display: flex; align-items: flex-start">
                              <ion-label style=" font-size:16px; margin:0; text-align:right;color:#434343; ">
                                {{o.sum_price|number}} บาท</ion-label>
                            </ion-item>
                          </ion-col>
                        </ion-row>
                      </ion-grid>
                    </div>
                  </div>
                </ng-template> -->

                <div *ngFor="let o of detail.food; let i = index">
                  <ng-template [ngIf]="!o.food_detail">  
                    <div class="store">
                      <div class="id_order" style="width:100%; margin-top:-10px;">
                        <ion-grid style="--ion-grid-padding:0">
                          <ion-row>
                            <ion-col size="8.5" style="--ion-grid-column-padding:0">
                              <ion-item lines="none" style="--background:none">
                                <ion-button (click)="editDetail(o)"  mode="ios" Fill="clear">
                                  <ion-icon name="pencil" color="dark"></ion-icon>
                                </ion-button>
                                <ion-label style="color: #434343; margin:0; font-size: 16px;">(x{{o.amount}}) {{o.food_name}} 
                                  <div *ngIf="o.option">
                                    <span *ngFor="let opt of o.option"
                                      style="padding-left: 25px; font-size: 14px; color: #666666;">*{{opt.title}}<br>
                                    </span>
                                  </div>
                                </ion-label>
                              </ion-item>
                            </ion-col>
                            <ion-col size="3.5" style="--ion-grid-column-padding:0">
                              <ion-item lines="none" style="--background:none; display: flex; align-items: flex-start">
                                <ion-label style=" font-size:16px; margin:0; text-align:right;color:#434343; ">
                                  {{o.sum_price|number}} บาท</ion-label>
                              </ion-item>
                            </ion-col>
                          </ion-row>
                        </ion-grid>
                      </div>
                    </div>
                  </ng-template>

                <!-- <div *ngFor="let editMFS of editMenuFromStorage.orderdetail">
                <ng-template [ngIf]="editMFS.food_detail">
                  <div class="store">
                    <div class="id_order" style="width:100%;">
                      <ion-grid style="--ion-grid-padding:0">
                        <ion-row>
                          <ion-col size="8.5" style="--ion-grid-column-padding:0">
                            <ion-item lines="none" style="--background:none">
                              <ion-label style=" margin:0; font-size: 16px;">(x{{editMenuFromStorage.amount}}) {{editMenuFromStorage.food_name}} <br>
                                <div *ngIf="o.option">
                                  <span *ngFor="let editMFS of editMenuFromStorage.amount"
                                    style="padding-left: 25px; font-size: 14px; color: #666666;">*{{opt.title}}<br></span>
                                </div>
                                <span style="padding-left: 25px;font-size: 13px;color:#979797; margin:0;">*
                                  {{editMenuFromStorage.food_detail}}</span>
                              </ion-label>
                            </ion-item>
                          </ion-col>
                          <ion-col size="3.5" style="--ion-grid-column-padding:0">
                            <ion-item lines="none" style=" vertical-align:top;--background:none;">
                              <ion-label
                                style=" font-size:16px; margin:0; margin-top: -20px; text-align:right;color:#434343; ">
                                {{editMenuFromStorage.sum_price|number}} บาท</ion-label>
                            </ion-item>
                          </ion-col>
                        </ion-row>
                      </ion-grid>
                    </div>
                  </div>
                </ng-template>
                </div> -->

                <ng-template [ngIf]="o.food_detail">
                  <div class="store">
                    <div class="id_order" style="width:100%;">
                      <ion-grid style="--ion-grid-padding:0">
                        <ion-row>
                          <ion-col size="8.5" style="--ion-grid-column-padding:0">
                            <ion-item lines="none" style="--background:none">
                              <ion-label style=" margin:0; font-size: 16px;">(x{{o.amount}}) {{o.food_name}} <br>
                                <div *ngIf="o.option">
                                  <span *ngFor="let opt of o.option"
                                    style="padding-left: 25px; font-size: 14px; color: #666666;">*{{opt.title}}<br></span>
                                </div>
                                <span style="padding-left: 25px;font-size: 13px;color:#979797; margin:0;">*
                                  {{o.food_detail}}</span>
                              </ion-label>
                            </ion-item>
                          </ion-col>
                          <ion-col size="3.5" style="--ion-grid-column-padding:0">
                            <ion-item lines="none" style=" vertical-align:top;--background:none;">
                              <ion-label
                                style=" font-size:16px; margin:0; margin-top: -20px; text-align:right;color:#434343; ">
                                {{o.sum_price|number}} บาท</ion-label>
                            </ion-item>
                          </ion-col>
                        </ion-row>
                      </ion-grid>

                    </div>

                  </div>
                </ng-template>
              </div>
            </ion-list>
          </ion-list>

          <ion-item lines="none" style="margin-top:10px; margin-bottom: 20px; --background:white;">
            <ion-label style="display: inline-block; font-size: 18px; width: calc(100% - 133px); color: #05be4f; ">
              รวมทั้งหมด
            </ion-label>
            <div style="display: inline-block;">
              <ion-label style="color: #05be4f; font-size: 18px; padding-right: 10px;">
                <!-- {{detail.order_price|number}} บาท -->
                {{sumToTal(detail)|number}} บาท
              </ion-label>
            </div>
          </ion-item>

          <ng-template [ngIf]="detail.statusOrStore_id == '1'">
            <div class="button-confirm">
              <ion-button type="submit" (click)="alertConfirmOrder(detail.order_id)">
                ทำอาหาร
              </ion-button>
              <div style="margin-bottom: 20px;"></div>
            </div>
          </ng-template>
          <ng-template [ngIf]="detail.statusOrStore_id == '1'">
            <div class="button-confirm">
              <ion-button type="submit" (click)="checkStatus_editListDetailMenu(detail.order_id)">
                แก้ไขเมนู
              </ion-button>
              <div style="margin-bottom: 20px;"></div>
            </div>
          </ng-template>
        </div>
      </div>
    </div>
  </div>
</ion-content>
